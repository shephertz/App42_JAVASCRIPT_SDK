var App42Constants={};(function(){this.Display_FullScreen_PopUp="Display_FullScreen_PopUp",this.Display_Alert_PopUp="Display_Alert_PopUp",this.Display_Confirm_PopUp="Display_Confirm_PopUp",this.START_SESSION_KEY="START SESSION",this.END_SESSION_KEY="END SESSION",this.TRACK_EVENT_KEY="EVENT",this.EVENTS_KEY="events",this.OS_KEY="os",this.POPUPTYPE_ALERT="Alert",this.POPUPTYPE_CONFIRM="confirmation",this.POPUPTYPE_INTERSTITIAL="interstitial",this.POPUP_IMAGE_HEADER="POPUP_IMAGE_HEADER",this.POPUP_IMAGE_CROSS_BTN="POPUP_IMAGE_CROSS_BTN",this.POPUP_IMAGE_BTNS="POPUP_IMAGE_BTNS",this.POPUP_IMAGE_ALERTBACK="POPUP_IMAGE_ALERTBACK",this.POPUP_IMAGE_BORDER="POPUP_IMAGE_BORDER",this.POPUP_IMAGE_FLSCRNBACK="POPUP_IMAGE_FLSCRNBACK",this.ACTION_TYPE_TRACKEVENT="trackEvent",this.ACTION_TYPE_ABTEST="abTest",this.ACTION_TYPE_CUSTOMCODE="customCode",this.ACTION_TYPE_OPENURL="openURL",this.FREQUENCY_TYPE_DAILY="Daily",this.FREQUENCY_TYPE_WEEKLY="Week",this.FREQUENCY_TYPE_MONTHLY="Month",this.FREQUENCY_TYPE_YEARLY="Year",this.App42_Campaign_Frequency="App42_Campaign_Frequency",this.App42_Campaigns_Config="App42_Campaigns_Config",this.DEVICE_CITY_KEY="APP42_DEVICE_CITY",this.DEVICE_COUNTRY_KEY="APP42_DEVICE_COUNTRY"}).apply(App42Constants);var App42Campaign={};(function(){this.campaignesPriorities=[],this.validCampaigns={},this.campaignesDict={},this.savedCampaigns={},this.backgroundURLDict={},this.campaigns={},this.saveCampaign=function(e,n){this.campaignesDict[e]=n,this.savedCampaigns[e]=n},this.getPriorityWiseCampaigns=function(){if(this.campaignesPriorities.length>0)for(var e=0;e<this.campaignesPriorities.length;e++){var n=this.campaignesPriorities[e];if(n in this.validCampaigns){var t=this.campaignesDict[this.campaignesPriorities[e]];this.campaigns[n]=t,delete this.validCampaigns[n]}}if(this.validCampaigns.length>0)for(var a in this.campaignesDict)this.campaigns[a]=this.campaignesDict[a];return this.campaigns},this.setCampaignPriorities=function(e){this.campaignesPriorities=e},this.saveBackGroundUrls=function(e,n){e in this.backgroundURLDict?App42Debugger.print("Duplicate Image Name"):this.backgroundURLDict[e]=n}}).apply(App42Campaign);var App42CampaignAPI={};(function(){this.enable=function(e){e&&(App42InAppMessaging.enableInAppMessaging(e),App42CampaignListener.initializeInAppMessaging())}}).apply(App42CampaignAPI);var App42LocalStorage={};(function(){this.Save=function(e,n){localStorage.setItem(e,n)},this.Remove=function(e){localStorage.removeItem(e)},this.Fetch=function(e){return localStorage.getItem(e)},this.HasKey=function(e){return localStorage.hasOwnProperty(e)?!0:!1}}).apply(App42LocalStorage);var App42CampaignsData={};(function(){var e,n,t,a,i,p,r,o,s,c,g,l,u,d,m,h,C,A,f,v={},E={},b={},D={};this.setCampaignData=function(v){var E={};for(var b in v)"campaignName"==b?(E.campaignName=v[b],A=v[b]):"maxUsers"==b?E.maxUsers=v[b]:"startDate"==b?E.startDate=new Date(v[b]):"endDate"==b?E.endDate=new Date(v[b]):"superProperties"==b?E.superPropertiesJson=v[b]:"installProperties"==b?E.installPropertiesJson=v[b]:"what"==b?(r=v[b],this.fetchWhatObject(v[b]),E.actionType=u,E.actionPropertiesJson=l,E.actionName=d,E.cancelType=h,E.cancelPropertiesJson=m,E.cancelName=C,E.popUpType=e,E.titleText=n,E.messageText=t,E.okBtnText=a,E.cancelBtnText=i,E.backgroundImageName=p):"when"==b?(o=v[b],this.fetchWhenObject(o,A)):"locations"==b?(E.locations=v[b],f=v[b],this.fetchLocationObject(f,A)):"frequency"==b?(s=v[b],this.fetchFrequency(v[b]),E.frequencyType=c,E.frequencyValue=g):"priority"==b?E.priority=v[b]:App42Debugger.print("key :: "+b+" :: Val :: "+v[b]+" <<<<======= Not Setted.");App42CampaignConfig.create(E,A,o)},this.fetchWhatObject=function(n){for(var t in n)"action"==t?this.fetchActionObject(n[t]):"cancel"==t?this.fetchCancelObject(n[t]):"type"==t?e=n[t]:"content"==t?this.fetchContentObject(n[t]):App42Debugger.print("key :: "+t+" :: Val :: "+n[t]+" <<<<======= Not Setted.")},this.fetchWhenObject=function(e,n){var t="os",a="events";if(t in e){var i=e.os;App42Debugger.print("sessionArray Event========>>>>> "+i[0]),v[n]=i}if(a in e){var p=e.events;E[n]=p}},this.fetchLocationObject=function(e,n){var t="cities",a="countries";if(t in e){var i=e.cities;b[n]=i}if(a in e){var p=e.countries;D[n]=p}},this.fetchFrequency=function(e){for(var n in e)"type"==n?c=e[n]:"value"==n?g=e[n]:App42Debugger.print("key :: "+n+" :: Val :: "+e[n]+" <<<<======= Not Setted.")},this.fetchActionObject=function(e){for(var n in e)"type"==n?u=e[n]:"properties"==n?l=e[n]:"name"==n?d=e[n]:App42Debugger.print("key :: "+n+" :: Val :: "+e[n]+" <<<<======= Not Setted.")},this.fetchCancelObject=function(e){for(var n in e)"type"==n?h=e[n]:"properties"==n?m=e[n]:"name"==n?C=e[n]:App42Debugger.print("key :: "+n+" :: Val :: "+e[n]+" <<<<======= Not Setted.")},this.fetchContentObject=function(e){for(var r in e)"titleText"==r?n=e[r]:"message"==r?t=e[r]:"okBtnText"==r?a=e[r]:"cancelBtnText"==r?i=e[r]:"backgroundImage"==r?p=e[r]:App42Debugger.print("key :: "+r+" :: Val :: "+e[r]+" <<<<=======Keys Not Setted.")}}).apply(App42CampaignsData);var App42CampaignConfig={};(function(){this.create=function(e,n,t){var a={};return a.popUpType=e.popUpType,a.eventsList=t,a.actionName=e.actionName,a.actionType=e.actionType,a.actionProperties=e.actionPropertiesJson,e.popUpType==App42Constants.POPUPTYPE_ALERT?(a.titleText=e.titleText,a.messageText=e.messageText,a.okBtnText=e.okBtnText):e.popUpType==App42Constants.POPUPTYPE_CONFIRM?(a.titleText=e.titleText,a.messageText=e.messageText,a.okBtnText=e.okBtnText,a.cancelName=e.cancelName,a.cancelType=e.cancelType,a.cancelProperties=e.cancelPropertiesJson,a.cancelBtnText=e.cancelBtnText):e.popUpType==App42Constants.POPUPTYPE_INTERSTITIAL?(a.backGroundImage=e.backgroundImageName,a.cancelName=e.cancelName,a.cancelType=e.cancelType,a.cancelProperties=e.cancelPropertiesJson):App42Debugger.print("Unknown CampaignType In App42CampaignConfig.Create"),a.superProperties=e.superPropertiesJson,a.installProperties=e.installPropertiesJson,a.locations=e.locations,a.frequencyType=e.frequencyType,a.frequencyValue=e.frequencyValue,a.endDate=e.endDate,a.startDate=e.startDate,App42Campaign.saveCampaign(n,a),a}}).apply(App42CampaignConfig);var CampaignValidator={};(function(){this.checkIfValidDateTime=function(e,n){var t=new Date(e),a=new Date(n),i=new Date;return App42Debugger.print("startDate === "+t+" ==== End Date === "+a+"Now Date :: "+i),i>t&&a>i?!0:!1},this.checkIfValidFrequency=function(e,n,t){var a=FrequencyManager.getOrUpdateFrequencyConfig(e,n,t);return App42Debugger.print("Valid OR Not :::: "+a),a}}).apply(CampaignValidator);var FrequencyManager={};(function(){this.getOrUpdateFrequencyConfig=function(e,n,t){var a=this.getFrequencyTypeInDays(n),i=!0;if(App42LocalStorage.HasKey(App42Constants.App42_Campaign_Frequency)){var p=[],r=App42LocalStorage.Fetch(App42Constants.App42_Campaign_Frequency),o=JSON.parse(r);App42Debugger.print("oldConfigArray ::: "+o),App42Debugger.print("oldConfigArray.length ::: "+o.length);for(var s=[],c=0;c<o.length;c++){var g=o[c].campaignName,l=o[c].frequencyTypeInDays,u=o[c].frequencyValue,d=o[c].campaignStartDateTime;if(App42Debugger.print("campaignNameInConfig ::: "+g+"  campaignName ::: "+e),g==e)if(this.checkFrequencyExpiry(l,d))if(this.checkFrequencyValue(u)){App42Debugger.print("Frequency Value LEFT :: "+(u-1));var m=u-1,h=this.updateConfig(e,l,m,d);s.push(h),p.push(e)}else App42Debugger.print("Frequency Value Reached the limit, LEFT :: "+u),s.push(o[c]),p.push(e),i=!1;else{App42Debugger.print("Renew Campaign :: "+g);var C=this.addConfig(e,a,t-1);s.push(C),p.push(e),i=!0}else s.push(o[c]),p.push(o[c].campaignName)}if(p.indexOf(e)>-1)App42Debugger.print("Campaign Already Saved "+e);else{var C=this.addConfig(e,a,t-1);s.push(C)}var A=JSON.stringify(s);App42LocalStorage.Save(App42Constants.App42_Campaign_Frequency,A)}else{var f=this.createConfig(e,a,t-1);App42LocalStorage.Save(App42Constants.App42_Campaign_Frequency,JSON.stringify(f)),App42Debugger.print("First Time ConFig Info "+App42LocalStorage.Fetch(App42Constants.App42_Campaign_Frequency))}return App42Debugger.print(":::: In SaveOrGetFrequencyConfig ::::: "),i},Date.prototype.getDOY=function(){var e=new Date(this.getFullYear(),0,1);return Math.ceil((this-e)/864e5)},this.checkFrequencyExpiry=function(e,n){var t=!1,a=new Date(n),i=new Date,p=i.getDOY()-a.getDOY();return App42Debugger.print("DaysCover :: "+p),t=e>p?!0:!1},this.checkFrequencyValue=function(e){var n=!1;return n=e>0?!0:!1},this.createConfig=function(e,n,t){var a={};a.campaignName=e,a.frequencyTypeInDays=n,a.frequencyValue=t,a.campaignStartDateTime=new Date;var i=[a];return App42Debugger.print("In createConfig : "+i),i},this.updateConfig=function(e,n,t,a){var i={};return i.campaignName=e,i.frequencyTypeInDays=n,i.frequencyValue=t,i.campaignStartDateTime=a,App42Debugger.print("Updated Config :: "+JSON.stringify(i)),i},this.addConfig=function(e,n,t){var a={};return a.campaignName=e,a.frequencyTypeInDays=n,a.frequencyValue=t,a.campaignStartDateTime=new Date,App42Debugger.print("Added Config :: "+JSON.stringify(a)),a},this.getFrequencyTypeInDays=function(e){var n=0;switch(e){case App42Constants.FREQUENCY_TYPE_DAILY:n=1;break;case App42Constants.FREQUENCY_TYPE_WEEKLY:n=7;break;case App42Constants.FREQUENCY_TYPE_MONTHLY:n=30;break;case App42Constants.FREQUENCY_TYPE_YEARLY:n=365;break;default:App42Debugger.print("Unknown Frequency Type ::: "+e)}return n}}).apply(FrequencyManager);var App42CampaignUIHandler={};(function(){this.showCampaign=function(e,n){e==App42Constants.Display_Alert_PopUp?(App42Debugger.print("In Show Alert Campaign"),this.alertCampaign(n)):e==App42Constants.Display_Confirm_PopUp?(App42Debugger.print("In Show Confirm Campaign"),this.confirmCampaign(n)):e==App42Constants.Display_FullScreen_PopUp?(App42Debugger.print("In Show FullScreen Campaign"),this.fullScreenCampaign(n)):App42Debugger.print("Unknown Campaign Type")},this.alertCampaign=function(e){var n=e.titleText,t=e.messageText,a=e.okBtnText,i=e.actionName,p=e.actionType,r=e.actionProperties;this.generateCSSForAlert();var o="campaignWrapper",s="headingDiv",c="messageDiv",g="campaignBox",l=window.innerWidth>0?window.innerWidth:screen.width;l>=320&&640>=l&&(o="campaignWrapperMobile",s="headingDivMobile",c="messageDivMobile",g="campaignBoxMobile");var u=document.createElement("div");u.className="fadeBackground";var d=document.createElement("div");d.className=o;var m=document.createElement("div");m.className="focusCSS";var h=document.createElement("div");h.className=g;var C=document.createElement("div");C.className="headerDiv";var A=document.createElement("div");A.className=s,A.innerHTML=n,C.appendChild(A);var f=document.createElement("div");f.className=c,f.innerHTML=t;var v=document.createElement("a");v.className="btnConfirm",v.onclick=function(){App42CampaignActions.executeAction(p,i,r),document.body.removeChild(u),document.body.removeChild(d)},v.innerHTML=a;var E=document.createElement("div");E.className="buttonsDiv",E.appendChild(v),h.appendChild(C),h.appendChild(f),h.appendChild(E),m.appendChild(h),d.appendChild(m),document.body.appendChild(u),document.body.appendChild(d)},this.confirmCampaign=function(e){var n=e.titleText,t=e.messageText,a=e.okBtnText,i=e.cancelBtnText,p=e.actionName,r=e.actionType,o=e.actionProperties,s=e.cancelName,c=e.cancelType,g=e.cancelProperties;this.generateCSSForAlert();var l="campaignWrapper",u="headingDiv",d="messageDiv",m="campaignBox",h=window.innerWidth>0?window.innerWidth:screen.width;h>=320&&640>=h&&(l="campaignWrapperMobile",u="headingDivMobile",d="messageDivMobile",m="campaignBoxMobile");var C=document.createElement("div");C.className="fadeBackground";var A=document.createElement("div");A.className=l;var f=document.createElement("div");f.className="focusCSS";var v=document.createElement("div");v.className=m;var E=document.createElement("div");E.className="headerDiv";var b=document.createElement("div");b.className=u,b.innerHTML=n,E.appendChild(b);var D=document.createElement("div");D.className=d,D.innerHTML=t;var T=document.createElement("a");T.className="btnConfirm",T.onclick=function(){App42CampaignActions.executeAction(r,p,o),document.body.removeChild(C),document.body.removeChild(A)},T.innerHTML=a;var y=document.createElement("a");y.className="btnCancle",y.onclick=function(){App42CampaignActions.executeAction(c,s,g),document.body.removeChild(C),document.body.removeChild(A)},y.innerHTML=i;var x=document.createElement("div");x.className="buttonsDiv",x.appendChild(T),x.appendChild(y),v.appendChild(E),v.appendChild(D),v.appendChild(x),f.appendChild(v),A.appendChild(f),document.body.appendChild(C),document.body.appendChild(A)},this.fullScreenCampaign=function(e){App42Debugger.print("In Show Full Screen Campaign");var n=e.backGroundImageUrl,t=e.actionName,a=e.actionType,i=e.actionProperties,p=e.cancelName,r=e.cancelType,o=e.cancelProperties;this.generateCSSForImageCampaign();var s="imageDiv",c=window.innerWidth>0?window.innerWidth:screen.width;c>=320&&640>=c&&(s="imageDivMobile");var g=document.createElement("div");g.className="fadeBack";var l=document.createElement("div");l.className=s;var u=document.createElement("div");u.className="imageContent";var d=document.createElement("span");d.className="cross",d.className+=" x-close";var m=document.createElement("span");m.innerHTML="X",d.appendChild(m),d.onclick=function(){App42CampaignActions.executeAction(r,p,o),document.body.removeChild(g),document.body.removeChild(l)};var h=new Image;h.src=n,h.onclick=function(){App42CampaignActions.executeAction(a,t,i),document.body.removeChild(g),document.body.removeChild(l)},u.appendChild(h),l.appendChild(d),l.appendChild(u),document.body.appendChild(g),document.body.appendChild(l)},this.generateCSSForAlert=function(){var e=document.createElement("style");e.type="text/css",e.innerHTML=".btnConfirm { position: relative;float: right; color: #fff!important; border: solid 1px #538312;background: linear-gradient(#7db72f, #4e7d0e);background: -moz-linear-gradient(#7db72f),#4e7d0e);background: -webkit-gradient(#7db72f),#4e7d0e);background: -o-linear-gradient(#7db72f),#4e7d0e);font-size: 12px; padding: .4em 1.5em .42em; zoom: 1; vertical-align: baseline; margin: 2px 20px 2px 2px; outline: none; cursor: pointer; text-align: center;text-decoration: none; font: 14px/100% Arial, Helvetica, sans-serif; text-shadow: 0 1px 1px rgba(0,0,0,.3);line-height: 1.5em; }.btnCancle { position: relative;float: right; color: #faddde; border: solid 1px #980c10;background: linear-gradient(#ed1c24, #aa1317);background: -moz-linear-gradient(#ed1c24, #aa1317);background: -webkit-gradient(#ed1c24, #aa1317);background: -o-linear-gradient(#ed1c24, #aa1317);font-size: 12px; padding: .4em 1.5em .42em; zoom: 1; vertical-align: baseline; margin: 2px; outline: none; cursor: pointer; text-align: center;text-decoration: none; font: 14px/100% Arial, Helvetica, sans-serif; text-shadow: 0 1px 1px rgba(0,0,0,.3);  box-shadow: inset 0px 1px 1px 0px rgba(255,255,255,0.4), 0px 2px 2px 0px rgba(0,0,0,0.2);line-height: 1.5em;  margin-right: 20px; }.fadeBackground { position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 9998; cursor: pointer; background-color: rgba(0, 0, 0, 0.8); }.campaignWrapper { width: 100%; height: 3169px; position: fixed; display: block; overflow: hidden; top: -500px; left: 0px; z-index: 999998; }.campaignWrapperMobile { width: 90%; height: 3169px; position: fixed; display: block; overflow: hidden; top: -500px; left: 5%; z-index: 999998; }.focusCSS { position: relative; width: 100%; z-index: 999997; top: 500px; left: 0px; visibility: visible; opacity: 1; }.campaignBox { padding: 0px; border: 1px solid #323232;; border-radius: 5px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); color: #111; background: #f8f8f8; position: relative; overflow: hidden; display: block; z-index: 999999; margin: 10% auto; height: 200px; width: 45%; font-family: Arial, Helvetica, sans-serif;}.campaignBoxMobile { padding: 0px; border: 1px solid #323232;; border-radius: 5px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); color: #111; background: #f8f8f8; position: relative; overflow: hidden; display: block; z-index: 999999; margin: 10% auto; height: 200px; width: 100%; font-family: Arial, Helvetica, sans-serif;}.headerDiv { background: #eee;width:100%;overflow: hidden;padding: 5px; }.headingDiv {text-align: center; font-weight: 700; padding: 10px 0px; color: #4b5159;text-shadow: none!important; font-size: 20px;}.headingDivMobile {text-align: center; font-weight: 700; padding: 10px 0px; color: #4b5159;text-shadow: none!important; font-size: 18px;}.messageDiv {color: #626C6D; padding: 40px 25px 25px 25px; font-size: 14px; text-shadow: none;}.messageDivMobile {color: #626C6D; padding: 35px 25px 25px 25px; font-size: 14px; text-shadow: none;}.buttonsDiv { background: #eee; width: 100%; overflow: hidden; padding: 5px; margin-top: 83px; position: absolute; bottom: 0; }",document.head.appendChild(e)},this.generateCSSForImageCampaign=function(){var e=document.createElement("style");e.type="text/css",e.innerHTML=".imageDiv { background-color: #fff; border-radius: 5px;   box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); color: #111;display: none; min-width: 450px; padding: 5px; left: 25%; position: fixed; z-index: 9999; opacity: 1; display: block; height: auto; width: 50%; margin: 8% 0 10% 0;}.imageDivMobile { background-color: #fff; border-radius: 5px;   box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); color: #111;display: none; min-width: 260px!important; padding: 5px; left: 4%; position: fixed; z-index: 9999; opacity: 1; display: block; height: auto; width: 90%; margin: 50% 0 10% 0;}.fadeBack { position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 9998; cursor: pointer; background-color: rgb(0, 0, 0); }.cross.x-close {padding: 8px 10px; position: absolute; right: -7px; top: -16px;  font-family: sans-serif;border: 3px solid rgba(255, 255, 255, 0.99);font-size: 15px; box-shadow: inset 0px 1px 1px 0px rgba(255,255,255,0.4), 0px 2px 2px 0px rgba(0,0,0,0.2); }.cross {  background-color: #FF0000; border-radius: 10px; box-shadow: 0 2px 3px rgba(0,0,0,0.3); color: #fff; cursor: pointer; display: inline-block; padding: 10px 20px; text-align: center; text-decoration: none; border-radius: 50%; }.imageContent { max-width: 100%; max-height: 100%; }img { max-width: 100%; max-height: 100%; cursor: pointer;}",document.head.appendChild(e)}}).apply(App42CampaignUIHandler);var App42CampaignActions={};(function(){this.executeAction=function(e,n,t){e==App42Constants.ACTION_TYPE_TRACKEVENT?this.executeTrackEvent(n,t):e==App42Constants.ACTION_TYPE_ABTEST?this.executeABTest(n):e==App42Constants.ACTION_TYPE_CUSTOMCODE?this.executeCustomCode(n,t):e==App42Constants.ACTION_TYPE_OPENURL?this.executeOpenURL(n):App42Debugger.print("Unknown Action Type : "+e)},this.executeTrackEvent=function(e,n){var t=new App42Event;t.trackEvent(e,n,{success:function(){App42Debugger.print(":::: TrackEvent Success  :::: ")},error:function(e){App42Debugger.print(":::: TrackEvent Errorr  :::: "+e)}})},this.executeABTest=function(e){var n=new App42ABTest;n.execute(e,{success:function(){App42Debugger.print(":::: ABTest Success  :::: ")},error:function(e){App42Debugger.print(":::: ABTest Errorr  :::: "+e)}})},this.executeCustomCode=function(e,n){var t=new App42CustomCodeService;t.runJavaCode(e,n,{success:function(){App42Debugger.print(":::: CustomCode Success  :::: ")},error:function(e){App42Debugger.print(":::: CustomCode Errorr  :::: "+e)}})},this.executeOpenURL=function(e){window.location=e}}).apply(App42CampaignActions);var App42CampaignListener={};(function(){function e(){App42Debugger.print("BLAHHHHHH"),navigator.geolocation?navigator.geolocation.getCurrentPosition(n,t):App42Debugger.print("Geolocation is not supported by this browser.")}function n(e){var n=e.coords.latitude,t=e.coords.longitude;App42Debugger.print("LocationJson lat :: "+n+"   lng:::: "+t),a(n,t)}function t(e){switch(e.code){case e.PERMISSION_DENIED:App42Debugger.print("User denied the request for Geolocation.");break;case e.POSITION_UNAVAILABLE:App42Debugger.print("Location information is unavailable.");break;case e.TIMEOUT:App42Debugger.print("The request to get user location timed out.");break;case e.UNKNOWN_ERROR:App42Debugger.print("An unknown error occurred.")}}function a(e,n){var t=new XMLHttpRequest,a=new XMLHttpRequest,i="http://maps.googleapis.com/maps/api/geocode/json?latlng="+e+","+n+"&sensor=true";t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){a=t.responseText;var e=JSON.parse(a);if("OK"==e.status){var n=e.results.length-3,i=e.results.length-2,p=e.results.length-1,r=e.results[n].address_components[0].long_name,o=e.results[p].address_components[0].short_name,s=e.results[i].address_components[0].long_name;App42LocalStorage.Save(App42Constants.DEVICE_CITY_KEY,r),App42LocalStorage.Save(App42Constants.DEVICE_COUNTRY_KEY,o),App42Debugger.print("city:: "+r+" ::country:: "+o+" ::state:: "+s)}else App42Debugger.print("No Results Found ::  "+e.status.ToString())}else App42Debugger.print("Error When fetching Location ")},t.open("GET",i,!0),t.send()}this.initializeInAppMessaging=function(){App42Debugger.print("Initializing InApp Messaging");var e;this.fireDeviceLocation(),sessionStorage.hasOwnProperty(App42Constants.App42_Campaigns_Config)?(e=sessionStorage.getItem(App42Constants.App42_Campaigns_Config),this.configureCampaigns(e)):e=this.getConfigFromServer()},this.configureCampaigns=function(e){var n=this;App42Debugger.print("Configuring Campaigns :: "+e);var t={},a={},i={},p={},r=JSON.parse(e);for(var o in r)if("priorities"==o){a=r[o];for(var s=[],c=0;c<a.length;c++)s.push(a[c]);App42Campaign.setCampaignPriorities(s)}else if("downloads"==o){i=r[o];for(var c=0;c<i.length;c++){var g=i[c].imageName,l=i[c].imageURL;App42Debugger.print("Saving URL : "+g+" : "+l),App42Campaign.saveBackGroundUrls(g,l)}}else if("version"==o)p=r[o];else if("campaigns"==o){t=r[o];for(var c=0;c<t.length;c++)App42CampaignsData.setCampaignData(t[c])}App42Debugger.print("DONE DONE DONE DONE DONE DONE DONE DONE DONE DONE DONE DONE "),n.checkValidCampaigns()},this.fireDeviceLocation=function(){App42Debugger.print("FireDeviceLocation InApp Messaging"),App42LocalStorage.HasKey(App42Constants.DEVICE_CITY_KEY)||App42LocalStorage.HasKey(App42Constants.DEVICE_COUNTRY_KEY)?App42Debugger.print("Device Location :: "+App42LocalStorage.Fetch(App42Constants.DEVICE_CITY_KEY)+", "+App42LocalStorage.Fetch(App42Constants.DEVICE_COUNTRY_KEY)):e()},this.getConfigFromServer=function(){var e=this;App42Debugger.print("=====Getting Config From Server=====");var n=new App42Event;n.getConfig({success:function(n){return App42Debugger.print("::: GetConfigFromServer Success  ::: "+n),sessionStorage.setItem(App42Constants.App42_Campaigns_Config,n),e.configureCampaigns(n),n},error:function(e){App42Debugger.print(":::: GetConfigFromServer Error  :::: "+e)}})},this.checkValidCampaigns=function(){App42Debugger.print("Checking Valid Campaigns");var e=this,n=[],t=!1,a=!1;for(var i in App42Campaign.savedCampaigns){var p=i,r=App42Campaign.savedCampaigns[i];App42Debugger.print("==========="+p+" >>>>>>>>>> "+JSON.stringify(r));var o=r;t=e.compareInstallPropsWithLocal(o.installProperties),a=e.compareLocationWithLocal(o.locations),t&&a&&(App42Debugger.print("Adding Valid Campaign "+p),n.push(p))}n.length>0?e.checkValidCampaignsOnServer(n):App42Debugger.print("No valid Campaigns Found In Local, Not checking on server")},this.compareInstallPropsWithLocal=function(e){App42Debugger.print("Install Props from Server :: "+JSON.stringify(e));var n,t=!1,a=_Keys._app42_oldUserProps_+App42.getLoggedInUser();App42LocalStorage.HasKey(a)?(n=App42LocalStorage.Fetch(a),App42Debugger.print("Install Props In Local :: "+n)):(n="{}",App42Debugger.print("Install Props NOT FOUND In Local "+n));var i=JSON.parse(n);if(Object.keys(e).length>0)for(var p in e)Object.keys(i).length>0&&p in i&&i[p]==e[p]&&(App42Debugger.print("InstallProps Found "+p+"  Value  "+i[p]),t=!0);else t=!0;return t},this.compareLocationWithLocal=function(e){App42Debugger.print("LocationJson from Server :: "+JSON.stringify(e));var n,t,a=!1;App42LocalStorage.HasKey(App42Constants.DEVICE_CITY_KEY)&&App42LocalStorage.HasKey(App42Constants.DEVICE_COUNTRY_KEY)?(n=App42LocalStorage.Fetch(App42Constants.DEVICE_CITY_KEY),t=App42LocalStorage.Fetch(App42Constants.DEVICE_COUNTRY_KEY),App42Debugger.print("City & Country In Local :: "+n+", "+t)):(App42Debugger.print("City & Country NOT FOUND In Local "),a=!0);var i=[],p=[];if("cities"in e&&"countries"in e)if(i=e.cities,p=e.countries,i.length>0||p.length>0){if(i.length>0)for(var r=0;r<i.length;r++)n==i[r]&&(App42Debugger.print("City Found :: "+n),a=!0);if(p.length>0)for(var r=0;r<p.length;r++)t==p[r]&&(App42Debugger.print("Country Found :: "+t),a=!0)}else a=!0;else App42Debugger.print(" Locations Obj Is Null "),a=!0;return a},this.checkValidCampaignsOnServer=function(e){App42Debugger.print("=====Checking Valid Campaigns On Server=====");var n=new App42Event;n.isAvailable(e,{success:function(e){App42Debugger.print("IS_AVAILABLE_RESPONSE :: "+e);var n={},t=[],a=JSON.parse(e);for(var i in a)if("campaigns"==i){n=a[i];for(var p=0;p<n.length;p++){var r=n[p].name,o=n[p].isAvailable;o?(App42Debugger.print("Valid Campaign Found :: "+r),t.push(r)):App42Debugger.print("InValid Campaign :: "+r)}}if(t.length>0)for(var p=0;p<t.length;p++){var s=t[p],c=App42Campaign.savedCampaigns;s in c&&(App42Debugger.print("<< Campaign Found >> "),App42Campaign.validCampaigns[s]=c[s])}else App42Debugger.print("<< No valid Campaigns found On server >> ")},error:function(e){App42Debugger.print(":::: IS_AVAILABLE_Error  :::: "+e)}})},this.checkCampaignConfig=function(e,n){App42Debugger.print("checkCampaignConfig : "+e+" eventName "+n),e==App42Constants.START_SESSION_KEY||e==App42Constants.END_SESSION_KEY?this.checkForEvents(App42Constants.OS_KEY,n):e==App42Constants.TRACK_EVENT_KEY?this.checkForEvents(App42Constants.EVENTS_KEY,n):App42Debugger.print("In CheckCampaignConfig, Unknown Config")},this.checkForEvents=function(e,n){var t=this.checkCampaignForEvent(e,n);"NOT_FOUND"==t?App42Debugger.print("EVENTS NOT FOUND IN CheckForEvents"):t in App42Campaign.campaigns?(App42Debugger.print("POPUP CONFIGURATION FOUND :: "+App42Campaign.campaigns[t]),this.showPopUp(App42Campaign.campaigns[t],t)):App42Debugger.print("POPUP CONFIGURATION NOT FOUND FOR :: "+t)},this.checkCampaignForEvent=function(e,n){var t={},a="NOT_FOUND";if(e==App42Constants.OS_KEY)App42Debugger.print("========App42Constants.OS_KEY======== "+App42Constants.OS_KEY+"------"+e),t=App42Campaign.getPriorityWiseCampaigns();else if(e==App42Constants.EVENTS_KEY){t=App42Campaign.getPriorityWiseCampaigns(),App42Debugger.print("========getPriorityWiseCampaigns===="+JSON.stringify(t));for(var i in t){App42Debugger.print("PriorityWiseCampaigns :: "+i+"  Value:: "+t[i]);for(var p=t[i],r=p.eventsList[App42Constants.EVENTS_KEY],o=0;o<r.length;o++){if(r[o].toUpperCase()==n)return a=i;a="NOT_FOUND"}}}else App42Debugger.print("In CheckCampaignForEvent, Unknown Config");return a},this.showPopUp=function(e,n){App42Debugger.print("Inside ShowPopUp Content :: "+JSON.stringify(e));var t,a,i,p,r,o,s,c,g,l,u,d,m,h,C,A={},f={},v={},E={},b={};for(var D in e)"titleText"==D?(t=e[D],b.titleText=t):"messageText"==D?(a=e[D],b.messageText=a):"okBtnText"==D?(i=e[D],b.okBtnText=i):"cancelBtnText"==D?(p=e[D],b.cancelBtnText=p):"popUpType"==D?r=e[D]:"backGroundImage"==D?(o=e[D],s=this.getBackgroundImageURL(o),b.backGroundImageUrl=s,b.backGroundImageName=o):"actionName"==D?(c=e[D],b.actionName=c):"actionType"==D?(g=e[D],b.actionType=g):"actionProperties"==D?(A=e[D],b.actionProperties=A):"cancelName"==D?(l=e[D],b.cancelName=l):"cancelType"==D?(u=e[D],b.cancelType=u):"cancelProperties"==D?(f=e[D],b.cancelProperties=f):"superProperties"==D?(v=e[D],b.superProperties=v):"installProperties"==D?(E=e[D],b.installProperties=E):"endDate"==D?(d=e[D],b.endDate=d):"startDate"==D?(m=e[D],b.startDate=m):"frequencyType"==D?h=e[D]:"frequencyValue"==D&&(C=e[D]);var T=CampaignValidator.checkIfValidDateTime(m,d),y=!1;T?(App42Debugger.print("CHECKING FREQUENCY FOR :: "+n+" :: "+h+" :: "+C),y=CampaignValidator.checkIfValidFrequency(n,h,C),App42Debugger.print("NowDateIsValid=====>>>>>>> "+T+"   IsValidFrequency========>>>>>> "+y),y?r==App42Constants.POPUPTYPE_ALERT?App42CampaignUIHandler.showCampaign(App42Constants.Display_Alert_PopUp,b):r==App42Constants.POPUPTYPE_CONFIRM?App42CampaignUIHandler.showCampaign(App42Constants.Display_Confirm_PopUp,b):r==App42Constants.POPUPTYPE_INTERSTITIAL?App42CampaignUIHandler.showCampaign(App42Constants.Display_FullScreen_PopUp,b):App42Debugger.print("Unknown PopUp Type..."):App42Debugger.print("::: FREQUENCY EXPIRED ::: ")):App42Debugger.print("::: DATE NOT FOUND ::: ")},this.getBackgroundImageURL=function(e){return App42Campaign.backgroundURLDict[e]}}).apply(App42CampaignListener);